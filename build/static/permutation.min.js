window.permutation=function(){return{global:window,keypress:keymage}}(),permutation.control=function(){function t(){return u.runEditor(c,e,o,i,a)}function n(){return u.runEditor(c,e)}function e(t,n,e){return u.evaluate(t,n,e)}function r(){return u.clearEditor(c)}function o(t){return u.logInput(s,t)}function i(t){return u.logResult(s,t)}function a(t){return u.logError(s,t)}var u=permutation,c=u.makeEditor(u.makeTextbox("editor")),s=u.makeLogger(u.makeTextbox("logger"));return u.keypress("ctrl-alt-enter",function(){t()}),u.keypress("ctrl-alt-backspace",function(){r()}),u.keypress("ctrl-shift-backspace",function(){r()}),u.keypress("ctrl-shift-enter",function(){t(),r()}),u.init(),c.setValue(u.intro()),c.clearSelection(),n(),{editor:c,logger:s}},function(){function t(t){return t}function n(t,n,e,o,i){var a=t.getValue();e=e||r,e(a),n(a,o,i)}function e(t){t.setValue("")}function r(){}permutation.makeEditor=t,permutation.runEditor=n,permutation.clearEditor=e}(),function(){function evaluate(input,succeed,fail){succeed=succeed||noop,fail=fail||thrower;try{succeed(eval(input))}catch(e){fail(e)}}function noop(){}function thrower(t){throw t}permutation.evaluate=evaluate}(),function(){function t(t,n){for(var e in n)n.hasOwnProperty(e)&&(e in t||(t[e]=n[e]))}permutation.extend=t}(),permutation.init=function(){function t(t){return s(t,r,o)}function n(){var t=a();return vv(t)(u)(p)(c)(s,f),t}var e=permutation.extend,r=warped.deepMap,o=warped.run,i=wires.sampler,a=sig.val,u=sig.update,c=sig.flatten,s=sig.map,l=sig.put,f=wires.out,p=museq.seq,d=museq.interval;window.result=t,window.samples={c:i("static/c.wav"),h:i("static/h.wav"),k:i("static/k.wav"),s:i("static/s.wav"),t:i("static/t.wav")},window.s1=n(),window.s2=n(),window.s3=n(),window.s4=n(),window.s5=n(),window.s6=n(),[sig,wires,museq,warped].forEach(function(t){e(window,t)}),l(d,1200)},function(){function t(){var t=o(u)(),a=vv(null)(i,r(2,c.length))(e,function(){return o(c)()})(n)();return n([t,"  (sync)","  (loop)","  (result)",a,"  (to, s1)"]).join("\n")}function n(t){return t.reduce(function(t,n){return a(t,n)})}var e=warped.map,r=warped.randInt,o=warped.randVal,i=warped.repeat,a=warped.concat,u=[function(){return["vv('k ~ k s ~ ~, h*4')","  (motif, samples)"]},function(){return["vv('c, k, [t*3, t*2]*2')","  (motif, samples)"]}],c=[function(){return["  (every, "+2*r(1,4)+", function(beats) {","    return vv(beats)","      (slice, -(beats.length / 2))","      (repeat, randInt(1, 2) * 2)","      (concatValues)","      ()","  })"]},function(){return["  (every, "+2*r(1,4)+", function(beats) {","    var i = -randInt(1, 2) * 2","    return concat(slice(beats, 0, i), vv(beats)","      (slice, i)","      (repeat, randInt(1, 2) * 2)","      (concatValues)","      ())","  })"]},function(){var t=-o([.2,.6,1.2,2,2.3,2.5]),n=r(2,3);return["  (every, "+n+", deepMap, ctl, {pitch: "+t+"})"]},function(){var t=o([.3,.5,1.5,3.3]),n=r(2,6);return["  (every, "+n+", deepMap, ctl, {pitch: "+t+"})"]}];permutation.intro=t}(),function(){function t(t){return t.setReadOnly(!0),t.renderer.setShowGutter(!1),t}function n(t,n){var e=t.getValue();n=e.length?[e,n].join("\n"):n,t.setValue(n),t.clearSelection()}function e(t){return["/*",t,"*/"].join("\n")}function r(t,e){n(t,e)}function o(t){n(t,"")}function i(t,r){n(t,e(r.stack)+"\n")}permutation.makeLogger=t,permutation.logInput=r,permutation.logResult=o,permutation.logError=i}(),function(){function t(t){var n=ace.edit(t),e=n.getSession();return n.$blockScrolling=1/0,n.setShowPrintMargin(!1),n.setTheme("ace/theme/monokai"),e.setUseWorker(!1),e.setMode("ace/mode/javascript"),n}permutation.makeTextbox=t}();