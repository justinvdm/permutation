window.permutation=function(){return{global:window,keypress:keymage}}(),permutation.control=function(){function t(){return a.runEditor(c,e,i,o,u)}function n(){return a.runEditor(c,e)}function e(t,n,e){return a.evaluate(t,n,e)}function r(){return a.clearEditor(c)}function i(t){return a.logInput(s,t)}function o(t){return a.logResult(s,t)}function u(t){return a.logError(s,t)}var a=permutation,c=a.makeEditor(a.makeTextbox("editor")),s=a.makeLogger(a.makeTextbox("logger"));return a.keypress("ctrl-alt-enter",function(){t()}),a.keypress("ctrl-alt-backspace",function(){r()}),a.keypress("ctrl-shift-backspace",function(){r()}),a.keypress("ctrl-shift-enter",function(){t(),r()}),a.init(),c.setValue(a.intro()),c.clearSelection(),n(),{editor:c,logger:s}},function(){function t(t){return t}function n(t,n,e,i,o){var u=t.getValue();e=e||r,e(u),n(u,i,o)}function e(t){t.setValue("")}function r(){}permutation.makeEditor=t,permutation.runEditor=n,permutation.clearEditor=e}(),function(){function evaluate(input,succeed,fail){succeed=succeed||noop,fail=fail||thrower;try{succeed(eval(input))}catch(e){fail(e)}}function noop(){}function thrower(t){throw t}permutation.evaluate=evaluate}(),function(){function t(t,n){for(var e in n)n.hasOwnProperty(e)&&(e in t||(t[e]=n[e]))}permutation.extend=t}(),permutation.init=function(){function t(t){return l(t,r,i)}function n(){var t=u();return vv(t)(a)(c)(d)(s)(l,p),t}var e=permutation.extend,r=warped.deepMap,i=warped.run,o=wires.sampler,u=sig.val,a=sig.ensure,c=sig.update,s=sig.flatten,l=sig.map,f=sig.put,p=wires.out,d=museq.seq,w=museq.interval;window.result=t,window.samples={c:o("/static/c.wav"),h:o("/static/h.wav"),k:o("/static/k.wav"),s:o("/static/s.wav"),t:o("/static/t.wav")},window.s1=n(),window.s2=n(),window.s3=n(),window.s4=n(),window.s5=n(),window.s6=n(),[sig,wires,museq,warped].forEach(function(t){e(window,t)}),f(w,1200)},function(){function t(){var t=i(a)(),u=vv(null)(o,r(2,c.length))(e,function(){return i(c)()})(n)();return n([t,"  (sync)","  (loop)","  (result)",u,"  (to, s1)"]).join("\n")}function n(t){return t.reduce(function(t,n){return u(t,n)})}var e=warped.map,r=warped.randInt,i=warped.randVal,o=warped.repeat,u=warped.concat,a=[function(){return["vv('k ~ k s ~ ~, h*4')","  (motif, samples)"]},function(){return["vv('c, k, [t*3, t*2]*2')","  (motif, samples)"]}],c=[function(){return["  (every, "+2*r(1,4)+", function(beats) {","    return vv(beats)","      (slice, -(beats.length / 2))","      (repeat, randInt(1, 2) * 2)","      (concatValues)","      ()","  })"]},function(){return["  (every, "+2*r(1,4)+", function(beats) {","    var i = -randInt(1, 2) * 2","    return concat(slice(beats, 0, i), vv(beats)","      (slice, i)","      (repeat, randInt(1, 2) * 2)","      (concatValues)","      ())","  })"]},function(){var t=-i([.2,.6,1.2,2,2.3,2.5]),n=r(2,3);return["  (every, "+n+", deepMap, ctl, {pitch: "+t+"})"]},function(){var t=i([.3,.5,1.5,3.3]),n=r(2,6);return["  (every, "+n+", deepMap, ctl, {pitch: "+t+"})"]}];permutation.intro=t}(),function(){function t(t){return t.setReadOnly(!0),t.renderer.setShowGutter(!1),t}function n(t,n){var e=t.getValue();n=e.length?[e,n].join("\n"):n,t.setValue(n),t.clearSelection()}function e(t){return["/*",t,"*/"].join("\n")}function r(t,e){n(t,e)}function i(t){n(t,"")}function o(t,r){n(t,e(r.stack)+"\n")}permutation.makeLogger=t,permutation.logInput=r,permutation.logResult=i,permutation.logError=o}(),function(){function t(t){var n=ace.edit(t),e=n.getSession();return n.setShowPrintMargin(!1),n.setTheme("ace/theme/monokai"),e.setUseWorker(!1),e.setMode("ace/mode/javascript"),n}permutation.makeTextbox=t}();